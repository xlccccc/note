## ä¸€ã€å®éªŒåç§°

å¤„ç† **KDD99** æ•°æ®é›†

## äºŒã€å®éªŒç›®çš„

å¯¹ **KDD99** æ•°æ®é›†è¿›è¡Œå¤„ç†ï¼Œè·å¾—ç»Ÿè®¡ä¿¡æ¯ã€‚

## ä¸‰ã€å®éªŒå†…å®¹

1. å¯¹â€œkddcup.data_10_percentâ€æ•°æ®é›†ï¼ˆwith labelï¼‰è¿›è¡Œå¤„ç†ï¼Œè·å¾—ç»Ÿè®¡ä¿¡æ¯

2. å¯¹â€œkddcup.testdata.unlabeledâ€æ•°æ®é›†è¿›è¡Œå¤„ç†ï¼Œè·å¾—ç»Ÿè®¡ä¿¡æ¯

3. æ ¹æ®â€œkddcup.data_10_percentâ€æ•°æ®é›†ï¼ˆwith labelï¼‰ åˆ†å‡ºä¸åŒç§ç±»çš„æ”»å‡»å’Œæ­£å¸¸æ•°æ®ï¼Œè·å¾—åŸºæœ¬çš„ç»Ÿè®¡ä¿¡æ¯

4. åˆ©â½¤labeledæ•°æ®é›†çš„ç»Ÿè®¡ç‰¹å¾ï¼Œåˆ†æunlabeledæ•°æ®é›†ã€‚å‡è®¾KDD99çš„æ­£å¸¸æ•°æ®é›†æœä»æ­£æ€åˆ†å¸ƒï¼Œåˆ™åœ¨ç½®ä¿¡åº¦ä¸º0.9çš„æƒ…å†µä¸‹ï¼Œè¯·æ£€éªŒunlabeledæ•°æ®é›†æ˜¯å¦å±äºæ­£å¸¸æ•°æ®ï¼Ÿï¼ˆæç¤ºï¼šé¦–å…ˆéœ€è¦è·å¾—ä¸€ä¸ªnormalçš„æ•°æ®æ ·æœ¬é›†ï¼Œç„¶åéœ€è¦æ’é™¤æ‰æ•°æ®é›†ä¸­æ— å…³featuresçš„å½±å“ï¼Œä¹‹åä»¥å¤„ç†åçš„æ•°æ®é›†ä¼°è®¡KDD99æ­£å¸¸æ•°æ®é›†çš„å‡å€¼å’Œæ–¹å·®ï¼Œç„¶ååˆ©ç”¨å‡è®¾æ£€éªŒï¼Œå¯¹åº”çš„å»æ£€éªŒunlabeledæ•°æ®é›†çš„ç›¸å…³æ€§è´¨ã€‚ï¼‰

5. æ‰©å±•ï¼šå°è¯•ä½¿ç”¨æœºå™¨å­¦ä¹ åˆ†ç±»ç®—æ³•åˆ©ç”¨labeledçš„æ•°æ®é›†è¿›è¡Œè®­ç»ƒï¼Œåœ¨ä½¿ç”¨å¯¹åº”æ¨¡å‹å¯¹unlabeledæ•°æ®é›†è¿›è¡Œåˆ†ç±»ã€‚

## å››ã€å®éªŒæ•°æ®åŠç»“æœåˆ†æ

**KDD99**ä¸€å…±æœ‰42é¡¹ç‰¹å¾ï¼Œå‰41é¡¹å¯åˆ†ä¸ºå››å¤§ç±»ï¼Œç¬¬42é¡¹ä¸º**å…¥ä¾µæ£€æµ‹è¯•éªŒç±»å‹æ ‡è¯†**

### 1.å•ä¸ª TCP è¿æ¥çš„åŸºæœ¬ç‰¹å¾(1~9)

| ç‰¹å¾åç§°       | æè¿°                                | ç±»å‹ |
| -------------- | ----------------------------------- | ---- |
| duration       | è¿æ¥æŒç»­çš„ç§’æ•°                      | è¿ç»­ |
| protocol_type  | åè®®ç±»å‹ï¼ŒTCP,UDP,ICMP              | ç¦»æ•£ |
| service        | ç›®æ ‡ä¸»æœºçš„ç½‘ç»œæœåŠ¡ç±»å‹ï¼Œå…±70ç§      | ç¦»æ•£ |
| flag           | è¿æ¥æ­£å¸¸æˆ–é”™è¯¯çš„çŠ¶æ€ï¼Œå…±11ç§        | ç¦»æ•£ |
| src_bytes      | ä»æºä¸»æœºåˆ°ç›®æ ‡ä¸»æœºçš„æ•°æ®å­—èŠ‚æ•°      | è¿ç»­ |
| dst_bytes      | ä»ç›®æ ‡ä¸»æœºåˆ°æºä¸»æœºçš„æ•°æ®å­—èŠ‚æ•°      | è¿ç»­ |
| land           | è‹¥è¿æ¥æ¥è‡ª/é€è¾¾åŒä¸€ä¸ªä¸»æœº/ç«¯å£åˆ™ä¸º1 | ç¦»æ•£ |
| wrong_fragment | é”™è¯¯åˆ†æ®µçš„æ•°é‡                      | è¿ç»­ |
| urgent         | åŠ æ€¥åŒ…çš„ä¸ªæ•°                        | è¿ç»­ |

#### è¡¥å……

> **service:**
>
> ```
> 'aol', 'auth', 'bgp', 'courier', 'csnet_ns','ctf', 'daytime', 'discard', 'domain', 'domain_u', 'echo', 'eco_i', 'ecr_i', 'efs', 'exec', 'finger', 'ftp', 'ftp_data','gopher', 'harvest', 'hostnames', 'http', 'http_2784', 'http_443', 'http_8001', 'imap4', 'IRC', 'iso_tsap','klogin', 'kshell', 'ldap', 'link', 'login', 'mtp', 'name', 'netbios_dgm', 'netbios_ns', 'netbios_ssn', 'netstat','nnsp', 'nntp', 'ntp_u', 'other', 'pm_dump', 'pop_2', 'pop_3', 'printer', 'private', 'red_i', 'remote_job', 'rje','shell', 'smtp', 'sql_net', 'ssh', 'sunrpc', 'supdup', 'systat', 'telnet', 'tftp_u', 'tim_i', 'time', 'urh_i', 'urp_i','uucp', 'uucp_path', 'vmnet', 'whois', 'X11', 'Z39_50'
> ```

>**flag**
>
>```
>'OTH', 'REJ', 'RSTO', 'RSTOS0', 'RSTR', 'S0', 'S1',
>'S2', 'S3', 'SF', 'SH'
>```
>

### 2.TCPè¿æ¥çš„å†…å®¹ç‰¹å¾(10~22)

| ç‰¹å¾åç§°           | æè¿°                                      | ç±»å‹ |
| ------------------ | ----------------------------------------- | ---- |
| hot                | è®¿é—®æ•æ„Ÿæ–‡ä»¶æˆ–ç›®å½•çš„æ¬¡æ•°                  | è¿ç»­ |
| num_failed_logins  | ç™»é™†å°è¯•å¤±è´¥çš„æ¬¡æ•°                        | è¿ç»­ |
| logged_in          | æˆåŠŸç™»é™†åˆ™ä¸º1ï¼Œå¦åˆ™ä¸º0                    | ç¦»æ•£ |
| num_compromised    | compromisedæ¡ä»¶å‡ºç°çš„æ¬¡æ•°                 | è¿ç»­ |
| root_shell         | è·å¾— **root shell** åˆ™ä¸º1ï¼Œå¦åˆ™ä¸º0        | ç¦»æ•£ |
| su_attempted       | è‹¥å‡ºç°"**su root**"å‘½ä»¤åˆ™ä¸º1ï¼Œå¦åˆ™ä¸º0     | ç¦»æ•£ |
| num_root           | **root **ç”¨æˆ·è®¿é—®æ¬¡æ•°                     | è¿ç»­ |
| num_file_creations | æ–‡ä»¶åˆ›å»ºæ“ä½œçš„æ¬¡æ•°                        | è¿ç»­ |
| num_shells         | ä½¿ç”¨ **shell** å‘½ä»¤çš„æ¬¡æ•°                 | è¿ç»­ |
| num_access_files   | è®¿é—®æ§åˆ¶æ–‡ä»¶çš„æ¬¡æ•°                        | è¿ç»­ |
| num_outbound_cmds  | ä¸€ä¸ª **FTP** ä¼šè¯ä¸­å‡ºæˆ˜è¿æ¥çš„æ¬¡æ•°         | è¿ç»­ |
| is_hot_login       | ç™»é™†æ˜¯å¦å±äº"**hot**"åˆ—è¡¨ï¼Œæ˜¯ä¸º1ï¼Œå¦åˆ™ä¸º0 | ç¦»æ•£ |
| is_guest_login     | è‹¥æ˜¯ **guest** ç™»é™†åˆ™ä¸º1                  | ç¦»æ•£ |

### 3.ä¸¤ç§’å†…ç½‘ç»œæµé‡ç»Ÿè®¡ç‰¹å¾(23~31)

| ç‰¹å¾åç§°           | æè¿°                                                         | ç±»å‹ |
| ------------------ | ------------------------------------------------------------ | ---- |
| count              | ä¸å½“å‰è¿æ¥å…·æœ‰ç›¸åŒçš„ç›®æ ‡ä¸»æœºçš„è¿æ¥æ•°                         | è¿ç»­ |
| srv_count          | ä¸å½“å‰è¿æ¥å…·æœ‰ç›¸åŒæœåŠ¡çš„è¿æ¥æ•°                               | è¿ç»­ |
| serror_rate        | åœ¨ä¸å½“å‰è¿æ¥å…·æœ‰ç›¸åŒç›®æ ‡ä¸»æœºçš„è¿æ¥ä¸­ï¼Œå‡ºç°"**SYN**"é”™è¯¯çš„è¿æ¥çš„ç™¾åˆ†æ¯” | è¿ç»­ |
| srv_serror_rate    | åœ¨ä¸å½“å‰è¿æ¥å…·æœ‰ç›¸åŒæœåŠ¡çš„è¿æ¥ä¸­ï¼Œå‡ºç°"**SYN**"é”™è¯¯çš„è¿æ¥çš„ç™¾åˆ†æ¯” | è¿ç»­ |
| rerror_rate        | åœ¨ä¸å½“å‰è¿æ¥å…·æœ‰ç›¸åŒç›®æ ‡ä¸»æœºçš„è¿æ¥ä¸­ï¼Œå‡ºç°""**REJ**"é”™è¯¯çš„è¿æ¥çš„ç™¾åˆ†æ¯” | è¿ç»­ |
| srv_rerror_rate    | åœ¨ä¸å½“å‰è¿æ¥å…·æœ‰ç›¸åŒæœåŠ¡çš„è¿æ¥ä¸­ï¼Œå‡ºç°"**REJ**"é”™è¯¯çš„è¿æ¥çš„ç™¾åˆ†æ¯” | è¿ç»­ |
| same_srv_rate      | åœ¨ä¸å½“å‰è¿æ¥å…·æœ‰ç›¸åŒç›®æ ‡ä¸»æœºçš„è¿æ¥ä¸­ï¼Œä¸å½“å‰è¿æ¥å…·æœ‰ç›¸åŒæœåŠ¡çš„è¿æ¥çš„ç™¾åˆ†æ¯” | è¿ç»­ |
| diff_srv_rate      | åœ¨ä¸å½“å‰è¿æ¥å…·æœ‰ç›¸åŒç›®æ ‡ä¸»æœºçš„è¿æ¥ä¸­ï¼Œä¸å½“å‰è¿æ¥å…·æœ‰ä¸åŒæœåŠ¡çš„è¿æ¥çš„ç™¾åˆ†æ¯” | è¿ç»­ |
| srv_diff_host_rate | åœ¨ä¸å½“å‰è¿æ¥å…·æœ‰ç›¸åŒæœåŠ¡çš„è¿æ¥ä¸­ï¼Œä¸å½“å‰è¿æ¥å…·æœ‰ä¸åŒç›®æ ‡ä¸»æœºçš„è¿æ¥çš„ç™¾åˆ†æ¯” | è¿ç»­ |

### 4.ä¸€ç™¾ä¸ªè¿æ¥ä¸­çš„ç½‘ç»œæµé‡ç»Ÿè®¡ç‰¹å¾(32~41)

| ç‰¹å¾åç§°                    | æè¿°                                                         | ç±»å‹ |
| --------------------------- | ------------------------------------------------------------ | ---- |
| dst_host_count              | ä¸å½“å‰è¿æ¥å…·æœ‰ç›¸åŒç›®æ ‡ä¸»æœºçš„è¿æ¥æ•°                           | è¿ç»­ |
| dst_host_srv_count          | ä¸å½“å‰è¿æ¥å…·æœ‰ç›¸åŒç›®æ ‡ä¸»æœºç›¸åŒæœåŠ¡çš„è¿æ¥æ•°                   | è¿ç»­ |
| dst_host_same_srv_rate      | ä¸å½“å‰è¿æ¥å…·æœ‰ç›¸åŒç›®æ ‡ä¸»æœºç›¸åŒæœåŠ¡çš„è¿æ¥æ‰€å çš„ç™¾åˆ†æ¯”         | è¿ç»­ |
| dst_host_diff_srv_rate      | ä¸å½“å‰è¿æ¥å…·æœ‰ç›¸åŒç›®æ ‡ä¸»æœºä¸åŒæœåŠ¡çš„è¿æ¥æ‰€å çš„ç™¾åˆ†æ¯”         | è¿ç»­ |
| dst_host_same_src_port_rate | ä¸å½“å‰è¿æ¥å…·æœ‰ç›¸åŒç›®æ ‡ä¸»æœºç›¸åŒæºç«¯å£çš„è¿æ¥æ‰€å çš„ç™¾åˆ†æ¯”       | è¿ç»­ |
| dst_host_srv_diff_host_rate | ä¸å½“å‰è¿æ¥å…·æœ‰ç›¸åŒç›®æ ‡ä¸»æœºç›¸åŒæœåŠ¡çš„è¿æ¥ä¸­ï¼Œä¸å½“å‰è¿æ¥å…·æœ‰ä¸åŒæºä¸»æœºçš„è¿æ¥æ‰€å çš„ç™¾åˆ†æ¯” | è¿ç»­ |
| dst_host_serror_rate        | ä¸å½“å‰è¿æ¥å…·æœ‰ç›¸åŒç›®æ ‡ä¸»æœºçš„è¿æ¥ä¸­ï¼Œå‡ºç°"**SYN**"é”™è¯¯çš„è¿æ¥æ‰€å çš„ç™¾åˆ†æ¯” | è¿ç»­ |
| dst_host_srv_serror_rate    | ä¸å½“å‰è¿æ¥å…·æœ‰ç›¸åŒç›®æ ‡ä¸»æœºç›¸åŒæœåŠ¡çš„è¿æ¥ä¸­ï¼Œå‡ºç°"**SYN**"é”™è¯¯çš„è¿æ¥æ‰€å çš„ç™¾åˆ†æ¯” | è¿ç»­ |
| dst_host_rerror_rate        | ä¸å½“å‰è¿æ¥å…·æœ‰ç›¸åŒç›®æ ‡ä¸»æœºçš„è¿æ¥ä¸­ï¼Œå‡ºç°"**REJ**"é”™è¯¯çš„è¿æ¥æ‰€å çš„ç™¾åˆ†æ¯” | è¿ç»­ |
| dst_host_srv_rerror_rate    | ä¸å½“å‰è¿æ¥å…·æœ‰ç›¸åŒç›®æ ‡ä¸»æœºç›¸åŒæœåŠ¡çš„è¿æ¥ä¸­ï¼Œå‡ºç°"**REJ**"é”™è¯¯çš„è¿æ¥æ‰€å çš„ç™¾åˆ†æ¯” | è¿ç»­ |

ç¬¬42é¡¹

| æ ‡è¯†ç±»å‹ | æè¿°                                 | å…·ä½“åˆ†ç±»æ ‡è¯†                                                 |
| -------- | ------------------------------------ | ------------------------------------------------------------ |
| Normal   | æ­£å¸¸è®°å½•                             | Normal                                                       |
| DOS      | æ‹’ç»æœåŠ¡æ”»å‡»                         | backã€landã€neptuneã€podã€smurfã€teardropã€apache2ã€mailbombã€processtableã€udpstorm |
| Probing  | ç›‘è§†å’Œå…¶ä»–æ¢                         | ipsweepã€nmapã€portsweepã€satanã€mscanã€saint                |
| R2L      | æ¥è‡ªè¿œç¨‹æœºå™¨çš„éæ³•è®¿é—®               | tp_writeã€guess_passwdã€imapã€multihopã€phfã€spyã€warezclientã€warezmasterã€multihopã€namedã€sendmailã€snmpgetattackã€wormã€xlockã€xsnoop |
| U2R      | æ™®é€šç”¨æˆ·å¯¹æœ¬åœ°è¶…çº§ç”¨æˆ·ç‰¹æƒçš„éæ³•è®¿é—® | buffer_overflowã€loadmoduleã€perlã€rootkitã€psã€sqlattackã€xtermã€httptunnel |

### å®éªŒç»“æœ

#### **1.å¯¹â€œkddcup.data_10_percentâ€æ•°æ®é›†ï¼ˆwith labelï¼‰è¿›è¡Œå¤„ç†ï¼Œè·å¾—ç»Ÿè®¡ä¿¡æ¯**

```python
import pandas as pd
import numpy as np
import matplotlib.pyplot as plt

labels =["duration","protocol_type","service","flag","src_bytes","dot_bytes","land","wrong_fragment","urgent","hot","num_failed_logins","logged_in","num_compromised","su_attempted","numroot","num_file_creations","num_shells","num_access_files","num_outbound_cmds","is_hot_login","is_guest_login","count","srv_count","serror_rate","srv_serror_rate","rerror_rate","srv_rerror_rate","same_srv_rate","same_srv_rate","diff_srv_rate","srv_diff_host_rate","dst_host_count","dst_host_srv_count","dst_host_same_srv_rate","dst_host_diff_srv_rate","dst_host_same_src_port_rate","dst_host_srv_diff_host_rate","dst_host_serror_rate","dst_host_srv_serror_rate","dst_host_rerror_rate","dst_host_srv_rerror_rate","label"]
df = pd.read_csv("./data/corrected-Test data with corrected labels")
df.columns = labels

def plot_pie_optimize(title, dict_value: dict, font_size):
    keys = list(dict_value.keys())
    values = np.array(list(dict_value.values()))
    patches, texts = plt.pie(values)
    labels = ['{} {:1.2f}% ({})'.format(i, j, v) for i, j, v in
              zip(keys, 100. * values / values.sum(), values)]  # æ„é€ å›¾ä¾‹æ•°æ®
    patches, labels, dummy = zip(*sorted(
        zip(patches, labels, values), key=lambda x: x[2], reverse=True))
    plt.legend(patches, labels, loc="center", bbox_to_anchor=(-0.1, 0.5), fontsize=font_size)
    plt.title(title)
    plt.tight_layout()
    plt.savefig("./dataimg/{}.png".format(title), dpi = 600, bbox_inches = 'tight') # ä½¿å¾—åˆ°çš„å›¾ç‰‡æ›´å®Œæ•´æ¸…æ™°

def plot_label(title, font_size):
    df_label = df.loc[:, title].value_counts()
    dict_value = {}
    for i in df_label.keys():
        dict_value[i] = df_label[i]
    plot_pie_optimize(title, dict_value, font_size)


plot_label("label", 5)
plot_label("flag", 6)
plot_label("protocol_type", 6)
```

å±•ç¤ºéƒ¨åˆ†æ•°æ®

![](https://raw.githubusercontent.com/xlccccc/Image/master/hexoblog/202212291140247.png)

![](https://raw.githubusercontent.com/xlccccc/Image/master/hexoblog/202212291147335.png)

![](https://raw.githubusercontent.com/xlccccc/Image/master/hexoblog/202212291147296.png)

#### **2.å¯¹â€œkddcup.testdata.unlabeledâ€æ•°æ®é›†è¿›è¡Œå¤„ç†ï¼Œè·å¾—ç»Ÿè®¡ä¿¡æ¯**

```python
import pandas as pd
import numpy as np
import matplotlib.pyplot as plt

labels =["duration","protocol_type","service","flag","src_bytes","dot_bytes","land","wrong_fragment","urgent","hot","num_failed_logins","logged_in","num_compromised","su_attempted","numroot","num_file_creations","num_shells","num_access_files","num_outbound_cmds","is_hot_login","is_guest_login","count","srv_count","serror_rate","srv_serror_rate","rerror_rate","srv_rerror_rate","same_srv_rate","same_srv_rate","diff_srv_rate","srv_diff_host_rate","dst_host_count","dst_host_srv_count","dst_host_same_srv_rate","dst_host_diff_srv_rate","dst_host_same_src_port_rate","dst_host_srv_diff_host_rate","dst_host_serror_rate","dst_host_srv_serror_rate","dst_host_rerror_rate","dst_host_srv_rerror_rate","label"]
df = pd.read_csv("./data/kddcup.data.corrected-The full data set")
df.columns = labels

def plot_pie_optimize(title, dict_value: dict, font_size):
    keys = list(dict_value.keys())
    values = np.array(list(dict_value.values()))
    patches, texts = plt.pie(values)
    labels = ['{} {:1.2f}% ({})'.format(i, j, v) for i, j, v in
              zip(keys, 100. * values / values.sum(), values)]  # æ„é€ å›¾ä¾‹æ•°æ®
    patches, labels, dummy = zip(*sorted(
        zip(patches, labels, values), key=lambda x: x[2], reverse=True))
    plt.legend(patches, labels, loc="center", bbox_to_anchor=(-0.1, 0.5), fontsize=font_size)
    plt.title(title)
    plt.tight_layout()
    plt.savefig("./dataimg/{}.png".format(title), dpi = 600, bbox_inches = 'tight') # ä½¿å¾—åˆ°çš„å›¾ç‰‡æ›´å®Œæ•´æ¸…æ™°

def plot_label(title, font_size):
    df_label = df.loc[:, title].value_counts()
    dict_value = {}
    for i in df_label.keys():
        dict_value[i] = df_label[i]
    plot_pie_optimize(title, dict_value, font_size)


plot_label("label", 5)
plot_label("flag", 6)
plot_label("protocol_type", 6)

```

å±•ç¤ºéƒ¨åˆ†æ•°æ®

![](https://raw.githubusercontent.com/xlccccc/Image/master/hexoblog/202212291149430.png)

![](https://raw.githubusercontent.com/xlccccc/Image/master/hexoblog/202212291149133.png)

![](https://raw.githubusercontent.com/xlccccc/Image/master/hexoblog/202212291149235.png)

#### **3.æ ¹æ®â€œkddcup.data_10_percentâ€æ•°æ®é›†ï¼ˆwith labelï¼‰ åˆ†å‡ºä¸åŒç§ç±»çš„æ”»å‡»å’Œæ­£å¸¸æ•°æ®ï¼Œè·å¾—åŸºæœ¬çš„ç»Ÿè®¡ä¿¡æ¯**

```python
import pandas as pd
import numpy as np
import matplotlib.pyplot as plt

labels =["duration","protocol_type","service","flag","src_bytes","dot_bytes","land","wrong_fragment","urgent","hot","num_failed_logins","logged_in","num_compromised","su_attempted","numroot","num_file_creations","num_shells","num_access_files","num_outbound_cmds","is_hot_login","is_guest_login","count","srv_count","serror_rate","srv_serror_rate","rerror_rate","srv_rerror_rate","same_srv_rate","same_srv_rate","diff_srv_rate","srv_diff_host_rate","dst_host_count","dst_host_srv_count","dst_host_same_srv_rate","dst_host_diff_srv_rate","dst_host_same_src_port_rate","dst_host_srv_diff_host_rate","dst_host_serror_rate","dst_host_srv_serror_rate","dst_host_rerror_rate","dst_host_srv_rerror_rate","label"]
df = pd.read_csv("./data/corrected-Test data with corrected labels")
df.columns = labels

def plot_pie_optimize(title, dict_value: dict, font_size):
    keys = list(dict_value.keys())
    values = np.array(list(dict_value.values()))
    patches, texts = plt.pie(values)
    labels = ['{} {:1.2f}% ({})'.format(i, j, v) for i, j, v in
              zip(keys, 100. * values / values.sum(), values)]  # æ„é€ å›¾ä¾‹æ•°æ®
    patches, labels, dummy = zip(*sorted(
        zip(patches, labels, values), key=lambda x: x[2], reverse=True))
    plt.legend(patches, labels, loc="center", bbox_to_anchor=(-0.1, 0.5), fontsize=font_size)
    plt.title(title)
    plt.tight_layout()
    plt.savefig("./dataimg/{}.png".format(title), dpi = 600, bbox_inches = 'tight') # ä½¿å¾—åˆ°çš„å›¾ç‰‡æ›´å®Œæ•´æ¸…æ™°


normal_label = ['normal']
dos_label = ['back','land','neptune','pod','smurf','teardrop','apache2','mailbomb','processtable','udpstorm']
probing_label = ['ipsweep','nmap','portsweep','satan','mscan','saint']
r2l_label = ['tp_write','guess_passwd','imap','multihop','phf','spy','warezclient','warezmaster','multihop','named','sendmail','snmpgetattack','worm','xlock','xsnoop']
u2r_label = ['buffer_overflow','loadmodule','perl','rootkit','ps','sqlattack','xterm','httptunnel']

final_label = ['Normal','Dos','Probing','R2l','U2r']
final_dict = {
    "Normal": 0,
    "Dos": 0,
    "Probing": 0,
    "R2l": 0,
    "U2r": 0
}

for i in normal_label:
    final_dict["Normal"] += df[df.values == i + '.'].__len__()

for i in dos_label:
    final_dict["Dos"] += df[df.values == i + '.'].__len__()

for i in probing_label:
    final_dict["Probing"] += df[df.values == i + '.'].__len__()

for i in r2l_label:
    final_dict["R2l"] += df[df.values == i + '.'].__len__()

for i in u2r_label:
    final_dict["U2r"] += df[df.values == i + '.'].__len__()

plot_pie_optimize("Attack data", final_dict, 8)

```

![](https://raw.githubusercontent.com/xlccccc/Image/master/hexoblog/202212291222924.png)

#### 4.åˆ©â½¤labeledæ•°æ®é›†çš„ç»Ÿè®¡ç‰¹å¾ï¼Œåˆ†æunlabeledæ•°æ®é›†ã€‚å‡è®¾KDD99çš„æ­£å¸¸æ•°æ®é›†æœä»æ­£æ€åˆ†å¸ƒï¼Œåˆ™åœ¨ç½®ä¿¡åº¦ä¸º0.9çš„æƒ…å†µä¸‹ï¼Œè¯·æ£€éªŒunlabeledæ•°æ®é›†æ˜¯å¦å±äºæ­£å¸¸æ•°æ®ï¼Ÿ

**æç¤ºï¼šé¦–å…ˆéœ€è¦è·å¾—ä¸€ä¸ªnormalçš„æ•°æ®æ ·æœ¬é›†ï¼Œç„¶åéœ€è¦æ’é™¤æ‰æ•°æ®é›†ä¸­æ— å…³featuresçš„å½±å“ï¼Œä¹‹åä»¥å¤„ç†åçš„æ•°æ®é›†ä¼°è®¡KDD99æ­£å¸¸æ•°æ®é›†çš„å‡å€¼å’Œæ–¹å·®ï¼Œç„¶ååˆ©ç”¨å‡è®¾æ£€éªŒï¼Œå¯¹åº”çš„å»æ£€éªŒunlabeledæ•°æ®é›†çš„ç›¸å…³æ€§è´¨ã€‚**

```python
import pandas as pd
import numpy as np

labels =["duration","protocol_type","service","flag","src_bytes","dot_bytes","land","wrong_fragment","urgent","hot","num_failed_logins","logged_in","num_compromised","su_attempted","numroot","num_file_creations","num_shells","num_access_files","num_outbound_cmds","is_hot_login","is_guest_login","count","srv_count","serror_rate","srv_serror_rate","rerror_rate","srv_rerror_rate","same_srv_rate","same_srv_rate","diff_srv_rate","srv_diff_host_rate","dst_host_count","dst_host_srv_count","dst_host_same_srv_rate","dst_host_diff_srv_rate","dst_host_same_src_port_rate","dst_host_srv_diff_host_rate","dst_host_serror_rate","dst_host_srv_serror_rate","dst_host_rerror_rate","dst_host_srv_rerror_rate","label"]
df = pd.read_csv("./data/corrected-Test data with corrected labels")
df1 = pd.read_csv("./data/kddcup.data.corrected-The full data set")
df.columns = labels
df1.columns = labels

normal_label = ['normal']
dos_label = ['back','land','neptune','pod','smurf','teardrop','apache2','mailbomb','processtable','udpstorm']
probing_label = ['ipsweep','nmap','portsweep','satan','mscan','saint']
r2l_label = ['tp_write','guess_passwd','imap','multihop','phf','spy','warezclient','warezmaster','multihop','named','sendmail','snmpgetattack','worm','xlock','xsnoop']
u2r_label = ['buffer_overflow','loadmodule','perl','rootkit','ps','sqlattack','xterm','httptunnel']

final_label = ['Normal','Dos','Probing','R2l','U2r']
final_dict = {
    "Normal": 0,
    "Dos": 0,
    "Probing": 0,
    "R2l": 0,
    "U2r": 0
}

for i in normal_label:
    df[df.values == i +'.'].to_csv('./label/normal/'+ i +'.csv', header=0, index=0)
    df1[df1.values == i +'.'].to_csv('./label1/normal/'+ i +'.csv', header=0, index=0)

for i in dos_label:
    df[df.values == i +'.'].to_csv('./label/dos/'+ i +'.csv', header=0, index=0)
    df1[df1.values == i +'.'].to_csv('./label1/dos/'+ i +'.csv', header=0, index=0)

for i in probing_label:
    df[df.values == i +'.'].to_csv('./label/probing/'+ i +'.csv', header=0, index=0)
    df1[df1.values == i +'.'].to_csv('./label1/probing/'+ i +'.csv', header=0, index=0)

for i in r2l_label:
    df[df.values == i +'.'].to_csv('./label/r2l/'+ i +'.csv', header=0, index=0)
    df1[df1.values == i +'.'].to_csv('./label1/r2l/'+ i +'.csv', header=0, index=0)

for i in u2r_label:
    df[df.values == i +'.'].to_csv('./label/u2r/'+ i +'.csv', header=0, index=0)
    df1[df1.values == i +'.'].to_csv('./label1/r2l/'+ i +'.csv', header=0, index=0)
```

å…ˆè·å¾—å„ç§ä¸åŒç§ç±»çš„æ•°æ®

![](https://raw.githubusercontent.com/xlccccc/Image/master/hexoblog/202212291544707.png)

```python
import pandas as pd
import numpy as np
from scipy.stats import norm

labels =["duration","protocol_type","service","flag","src_bytes","dot_bytes","land","wrong_fragment","urgent","hot","num_failed_logins","logged_in","num_compromised","su_attempted","numroot","num_file_creations","num_shells","num_access_files","num_outbound_cmds","is_hot_login","is_guest_login","count","srv_count","serror_rate","srv_serror_rate","rerror_rate","srv_rerror_rate","same_srv_rate","same_srv_rate","diff_srv_rate","srv_diff_host_rate","dst_host_count","dst_host_srv_count","dst_host_same_srv_rate","dst_host_diff_srv_rate","dst_host_same_src_port_rate","dst_host_srv_diff_host_rate","dst_host_serror_rate","dst_host_srv_serror_rate","dst_host_rerror_rate","dst_host_srv_rerror_rate","label"]
df = pd.read_csv("./label/normal/normal.csv")
df1 = pd.read_csv("./label1/normal/normal.csv")
df.columns = labels

# è®¡ç®— labeled æ•°æ®é›†ä¸­ç‰¹å¾çš„å‡å€¼å’Œæ ‡å‡†å·®
feature = "duration"	# ä»¥ duration ä¸ºä¾‹
mean = df.mean(numeric_only = True)[feature]
std = df.std(numeric_only = True)[feature]

# åˆå§‹åŒ–æ¦‚ç‡å’Œè®¡æ•°å™¨
probability_sum = 0
count = 0

# éå† unlabeled æ•°æ®é›†ä¸­çš„æ¯ä¸ªæ•°æ®ç‚¹
for value in df[feature].values:
  # è®¡ç®—æ•°æ®ç‚¹åœ¨å‡è®¾æ­£å¸¸æ•°æ®æœä»æ­£æ€åˆ†å¸ƒçš„æƒ…å†µä¸‹çš„æ¦‚ç‡
  probability = norm.pdf(value, mean, std)
  # ç´¯åŠ æ¦‚ç‡å’Œè®¡æ•°å™¨
  probability_sum += probability
  count += 1

# è®¡ç®—å¹³å‡æ¦‚ç‡
mean_probability = probability_sum / count
print(mean_probability)
#å°†å¹³å‡æ¦‚ç‡ä¸æ‰€éœ€çš„ç½®ä¿¡åº¦è¿›è¡Œæ¯”è¾ƒ
if mean_probability > 0.9:
    print("Unlabeled dataset is likely to belong to normal data.")
else:
    print("Unlabeled dataset is not likely to belong to normal data.")
```

> Unlabeled dataset is not likely to belong to normal data.



## äº”ã€å®éªŒè¿‡ç¨‹ã€æ€»ç»“ä¸åˆ†æ

### å¤„ç†æ•°æ®

å‚è€ƒèœé¸Ÿæ•™ç¨‹çš„ç¤ºä¾‹ï¼Œå¯å‘ç°**pandasåº“**å¯¹csvï¼Œä¹Ÿå°±æ˜¯æœ¬å®éªŒç»™å‡ºçš„æ•°æ®æ˜¯å¾ˆå¥½å¤„ç†çš„

![](https://raw.githubusercontent.com/xlccccc/Image/master/hexoblog/202212291052328.png)

```python
import pandas as pd
labels =["duration","protocol_type","service","flag","src_bytes","dot_bytes","land","wrong_fragment","urgent","hot","num_failed_logins","logged_in","num_compromised","su_attempted","numroot","num_file_creations","num_shells","num_access_files","num_outbound_cmds","is_hot_login","is_guest_login","count","srv_count","serror_rate","srv_serror_rate","rerror_rate","srv_rerror_rate","same_srv_rate","same_srv_rate","diff_srv_rate","srv_diff_host_rate","dst_host_count","dst_host_srv_count","dst_host_same_srv_rate","dst_host_diff_srv_rate","dst_host_same_src_port_rate","dst_host_srv_diff_host_rate","dst_host_serror_rate","dst_host_srv_serror_rate","dst_host_rerror_rate","dst_host_srv_rerror_rate","label"]
df = pd.read_csv("test.txt")
df.columns = labels
df_dict = df.loc[:,"duration"].value_counts()
```

ä»è€Œæ ¹æ®æ¡ˆä¾‹ç¼–å†™å‡ºå¦‚ä¸‹ä»£ç ï¼Œå¯ä»¥å¾—åˆ°**duration**è¡Œçš„ç»Ÿè®¡æ•°æ®

```
0    6
1    4
2    2
Name: duration, dtype: int64
```

å¯¹å…¶è¿›è¡Œç®€å•å¤„ç†

```python
dict = {}
for i in df_dict.keys():
    dict[i] = df_dict[i]
keys = np.array(list(dict.keys()))
values = np.array(list(dict.values()))
```

å¯ä»¥å¾—åˆ°

```
keys: [0, 1, 2]
values: [6 4 2]
```

æ­£å¥½æ»¡è¶³ **Matplotlib** ç»˜åˆ¶é¥¼å›¾éœ€è¦çš„æ•°æ®

### Matplotlib é¥¼å›¾

æ ¹æ®èœé¸Ÿæ•™ç¨‹ä»¥ä¸‹ä»£ç ï¼Œå¯å¾—åˆ°

```python
import matplotlib.pyplot as plt
import numpy as np

y = np.array([35, 25, 25, 15])

plt.pie(y,
        labels=['A','B','C','D'], # è®¾ç½®é¥¼å›¾æ ‡ç­¾
        colors=["#d5695d", "#5d8ca8", "#65a479", "#a564c9"], # è®¾ç½®é¥¼å›¾é¢œè‰²
       )
plt.title("RUNOOB Pie Test") # è®¾ç½®æ ‡é¢˜
plt.show()
```

![](https://raw.githubusercontent.com/xlccccc/Image/master/hexoblog/202212291142167.png)

åœ¨ä¸Šé¢å¯¹æµ‹è¯•æ•°æ®çš„å¤„ç†ä¸‹å¯¹è¯¥ä»£ç è¿›è¡Œæ”¹å˜å¯å¾—åˆ°

```python
import pandas as pd
import numpy as np
import matplotlib.pyplot as plt

labels =["duration","protocol_type","service","flag","src_bytes","dot_bytes","land","wrong_fragment","urgent","hot","num_failed_logins","logged_in","num_compromised","su_attempted","numroot","num_file_creations","num_shells","num_access_files","num_outbound_cmds","is_hot_login","is_guest_login","count","srv_count","serror_rate","srv_serror_rate","rerror_rate","srv_rerror_rate","same_srv_rate","same_srv_rate","diff_srv_rate","srv_diff_host_rate","dst_host_count","dst_host_srv_count","dst_host_same_srv_rate","dst_host_diff_srv_rate","dst_host_same_src_port_rate","dst_host_srv_diff_host_rate","dst_host_serror_rate","dst_host_srv_serror_rate","dst_host_rerror_rate","dst_host_srv_rerror_rate","label"]
df = pd.read_csv("test.txt")
df.columns = labels
df_dict = df.loc[:,"duration"].value_counts()
dict = {}
for i in df_dict.keys():
    dict[i] = df_dict[i]
keys = np.array(list(dict.keys()))
values = np.array(list(dict.values()))
y = values

plt.pie(y,
        labels=np.array(keys), # è®¾ç½®é¥¼å›¾æ ‡ç­¾
        colors=["#d5695d", "#5d8ca8", "#65a479"], # è®¾ç½®é¥¼å›¾é¢œè‰²
       )
plt.title("Duration Pie Test") # è®¾ç½®æ ‡é¢˜
plt.show()
```

![](https://raw.githubusercontent.com/xlccccc/Image/master/hexoblog/202212291142290.png)

è€Œç”±äºæœ¬é¢˜ä¸­çš„æ•°æ®è¿‡å¤šè¿‡æ‚ï¼Œå°†æ•°æ®åç§°æ˜¾ç¤ºåœ¨æ¯ä¸ªæ‰‡å½¢çš„æ—è¾¹æ˜¯ä¸ç°å®çš„ï¼Œéœ€è¦æœ‰ä¸€ä¸ªå›¾ä¾‹å®ç°å¦‚ä¸‹æ•ˆæœ

![](https://raw.githubusercontent.com/xlccccc/Image/master/hexoblog/202212291142994.png)

å‚è€ƒ	https://blog.csdn.net/weixin_35757704/article/details/126965333

æ ¹æ®å…¶ä»£ç ï¼Œå¯å¾—åˆ°

```python
import pandas as pd
import numpy as np
import matplotlib.pyplot as plt

labels =["duration","protocol_type","service","flag","src_bytes","dot_bytes","land","wrong_fragment","urgent","hot","num_failed_logins","logged_in","num_compromised","su_attempted","numroot","num_file_creations","num_shells","num_access_files","num_outbound_cmds","is_hot_login","is_guest_login","count","srv_count","serror_rate","srv_serror_rate","rerror_rate","srv_rerror_rate","same_srv_rate","same_srv_rate","diff_srv_rate","srv_diff_host_rate","dst_host_count","dst_host_srv_count","dst_host_same_srv_rate","dst_host_diff_srv_rate","dst_host_same_src_port_rate","dst_host_srv_diff_host_rate","dst_host_serror_rate","dst_host_srv_serror_rate","dst_host_rerror_rate","dst_host_srv_rerror_rate","label"]
df = pd.read_csv("test.txt")
df.columns = labels
df_dict = df.loc[:,"duration"].value_counts()
dict_value = {}
for i in df_dict.keys():
    dict_value[i] = df_dict[i]
keys = list(dict_value.keys())
values = np.array(list(dict_value.values()))
patches, texts = plt.pie(values)
labels = ['{} {:1.2f}% ({})'.format(i, j, v) for i, j, v in
    zip(keys, 100. * values / values.sum(), values)]  # æ„é€ å›¾ä¾‹æ•°æ®
patches, labels, dummy = zip(*sorted(
    zip(patches, labels, values), key=lambda x: x[2], reverse=True))
plt.legend(patches, labels, loc="center", bbox_to_anchor=(-0.1, 0.5), fontsize=8)
plt.tight_layout()
plt.show()
```

![](https://raw.githubusercontent.com/xlccccc/Image/master/hexoblog/202212291142469.png)

å°†å…¶æ•´åˆä¸ºä¸¤ä¸ªå‡½æ•°å¹¶ç¨å¾®æ”¹è¿›

```python
import pandas as pd
import numpy as np
import matplotlib.pyplot as plt

labels =["duration","protocol_type","service","flag","src_bytes","dot_bytes","land","wrong_fragment","urgent","hot","num_failed_logins","logged_in","num_compromised","su_attempted","numroot","num_file_creations","num_shells","num_access_files","num_outbound_cmds","is_hot_login","is_guest_login","count","srv_count","serror_rate","srv_serror_rate","rerror_rate","srv_rerror_rate","same_srv_rate","same_srv_rate","diff_srv_rate","srv_diff_host_rate","dst_host_count","dst_host_srv_count","dst_host_same_srv_rate","dst_host_diff_srv_rate","dst_host_same_src_port_rate","dst_host_srv_diff_host_rate","dst_host_serror_rate","dst_host_srv_serror_rate","dst_host_rerror_rate","dst_host_srv_rerror_rate","label"]
df = pd.read_csv("./data/corrected-Test data with corrected labels")
df.columns = labels

def plot_pie_optimize(title, dict_value: dict, font_size):
    keys = list(dict_value.keys())
    values = np.array(list(dict_value.values()))
    patches, texts = plt.pie(values)
    labels = ['{} {:1.2f}% ({})'.format(i, j, v) for i, j, v in
              zip(keys, 100. * values / values.sum(), values)]  # æ„é€ å›¾ä¾‹æ•°æ®
    patches, labels, dummy = zip(*sorted(
        zip(patches, labels, values), key=lambda x: x[2], reverse=True))
    plt.legend(patches, labels, loc="center", bbox_to_anchor=(-0.1, 0.5), fontsize=font_size)
    plt.title(title)
    plt.tight_layout()
    plt.savefig("./dataimg/{}.png".format(title), dpi = 600, bbox_inches = 'tight') # ä½¿å¾—åˆ°çš„å›¾ç‰‡æ›´å®Œæ•´æ¸…æ™°

def plot_label(title, font_size):
    df_label = df.loc[:, title].value_counts()
    dict_value = {}
    for i in df_label.keys():
        dict_value[i] = df_label[i]
    plot_pie_optimize(title, dict_value, font_size)


plot_label("flag", 6)
```

![](https://raw.githubusercontent.com/xlccccc/Image/master/hexoblog/202212291140247.png)

å­¦åˆ°äº†æ€ä¹ˆç”¨pythonæ¥å¤„ç†è¿™äº›å¤æ‚çš„æ•°æ®ä»¥åŠè¿›è¡Œä¸€å®šçš„æ¦‚ç‡è®ºè¿ç®—

## å‚è€ƒé“¾æ¥

https://www.runoob.com/pandas/pandas-csv-file.html

https://www.runoob.com/w3cnote/matplotlib-tutorial.html

https://www.runoob.com/numpy/numpy-tutorial.html

https://www.runoob.com/matplotlib/matplotlib-pie.html

https://juejin.cn/post/7031475009688191007

https://blog.csdn.net/weixin_35757704/article/details/126965333

è¿˜æœ‰zç¥çš„å®éªŒæŠ¥å‘ŠğŸ¤—
